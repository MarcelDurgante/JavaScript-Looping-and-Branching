<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="styles.css" />
  </head>

  <body>
    <table id="stocks">
      <thead>
        <tr>
          <th>Company</th>
          <th>Symbol</th>
          <th>Industry</th>
          <th>Shares (in Billion)</th>
          <th>Price</th>
          <th>Beta</th>
        </tr>
      </thead>
      <tr>
        <td>Microsoft</td>
        <td>MSFT</td>
        <td>Tech</td>
        <td>7.46</td>
        <td>220</td>
        <td>0.96</td>
      </tr>
      <tr>
        <td>Apple</td>
        <td>APPL</td>
        <td>Tech</td>
        <td>16.07</td>
        <td>142</td>
        <td>1.25</td>
      </tr>
      <tr>
        <td>Amazon</td>
        <td>AMZN</td>
        <td>Retail</td>
        <td>10.19</td>
        <td>113</td>
        <td>1.32</td>
      </tr>
      <tr>
        <td>Alphabet Inc.</td>
        <td>GOOG</td>
        <td>Tech</td>
        <td>13</td>
        <td>100</td>
        <td>1.10</td>
      </tr>
      <tr>
        <td>Walmart</td>
        <td>WMT</td>
        <td>Retail</td>
        <td>2.71</td>
        <td>131</td>
        <td>0.51</td>
      </tr>
      <tr>
        <td>Exxon Mobil</td>
        <td>XOM</td>
        <td>Petroleum</td>
        <td>4.17</td>
        <td>101</td>
        <td>1.05</td>
      </tr>
      <tr>
        <td>JP Morgan</td>
        <td>JPM</td>
        <td>Financial Services</td>
        <td>2.93</td>
        <td>115</td>
        <td>1.07</td>
      </tr>
      <tr>
        <td>Intel</td>
        <td>INTC</td>
        <td>Tech</td>
        <td>4.11</td>
        <td>26</td>
        <td>0.71</td>
      </tr>
      <tr>
        <td>International Business Machines</td>
        <td>IBM</td>
        <td>Tech</td>
        <td>0.9</td>
        <td>121</td>
        <td>0.83</td>
      </tr>
      <tr>
        <td>Tesla</td>
        <td>TSLA</td>
        <td>Automotive</td>
        <td>3.13</td>
        <td>215</td>
        <td>2.13</td>
      </tr>
      <tr>
        <td>Pfizer</td>
        <td>PFE</td>
        <td>Pharmaceuticals</td>
        <td>5.61</td>
        <td>43</td>
        <td>0.64</td>
      </tr>
      <tr>
        <td>DocuSign</td>
        <td>DOCU</td>
        <td>Tech</td>
        <td>0.2</td>
        <td>46</td>
        <td>1.21</td>
      </tr>
      <tr>
        <td>EPAM Systems</td>
        <td>EPAM</td>
        <td>Tech</td>
        <td>0.057</td>
        <td>333</td>
        <td>1.68</td>
      </tr>
      <tr>
        <td>GitLab</td>
        <td>GTLB</td>
        <td>Software</td>
        <td>0.148</td>
        <td>45</td>
        <td></td>
      </tr>
    </table>
  </body>

  <script>
    const table = document.getElementById("stocks");
    const rows = table.getElementsByTagName("tr");

    // Iterate with a 'For' loop
    let stockData = [];
    for (let i = 1; i < rows.length; i++) {
      stockData.push(rows[i].innerText.split("\t"));
    }

    console.log("For loop", stockData);
    /* Output: 

   (14) [Array(6), Array(6), Array(6), Array(6), Array(6), Array(6), Array(6), Array(6), Array(6), Array(6), Array(6), Array(6), Array(6), Array(6)]
0: (6) ['Microsoft', 'MSFT', 'Tech', '7.46', '220', '0.96']
1: (6) ['Apple', 'APPL', 'Tech', '16.07', '142', '1.25']
2: (6) ['Amazon', 'AMZN', 'Retail', '10.19', '113', '1.32']
3: (6) ['Alphabet Inc.', 'GOOG', 'Tech', '13', '100', '1.10']
4: (6) ['Walmart', 'WMT', 'Retail', '2.71', '131', '0.51']
5: (6) ['Exxon Mobil', 'XOM', 'Petroleum', '4.17', '101', '1.05']
6: (6) ['JP Morgan', 'JPM', 'Financial Services', '2.93', '115', '1.07']
7: (6) ['Intel', 'INTC', 'Tech', '4.11', '26', '0.71']
8: (6) ['International Business Machines', 'IBM', 'Tech', '0.9', '121', '0.83']
9: (6) ['Tesla', 'TSLA', 'Automotive', '3.13', '215', '2.13']
10: (6) ['Pfizer', 'PFE', 'Pharmaceuticals', '5.61', '43', '0.64']
11: (6) ['DocuSign', 'DOCU', 'Tech', '0.2', '46', '1.21']
12: (6) ['EPAM Systems', 'EPAM', 'Tech', '0.057', '333', '1.68']
13: (6) ['GitLab', 'GTLB', 'Software', '0.148', '45', '']
length: 14 
*/

    // Iterate with a 'For...of' loop. Simpler and no mention of the index
    let stockData_2 = [];
    for (let row of rows) {
      stockData_2.push(row.innerText.split("\t"));
    }

    console.log("For...of 2", stockData_2);

    /* Output: 

(15) [Array(6), Array(6), Array(6), Array(6), Array(6), Array(6), Array(6), Array(6), Array(6), Array(6), Array(6), Array(6), Array(6), Array(6), Array(6)]
0:(6) ['Company', 'Symbol', 'Industry', 'Shares (in Billion)', 'Price', 'Beta']
1:(6) ['Microsoft', 'MSFT', 'Tech', '7.46', '220', '0.96']
2:(6) ['Apple', 'APPL', 'Tech', '16.07', '142', '1.25']
3:(6) ['Amazon', 'AMZN', 'Retail', '10.19', '113', '1.32']
4:(6) ['Alphabet Inc.', 'GOOG', 'Tech', '13', '100', '1.10']
5:(6) ['Walmart', 'WMT', 'Retail', '2.71', '131', '0.51']
6:(6) ['Exxon Mobil', 'XOM', 'Petroleum', '4.17', '101', '1.05']
7:(6) ['JP Morgan', 'JPM', 'Financial Services', '2.93', '115', '1.07']
8:(6) ['Intel', 'INTC', 'Tech', '4.11', '26', '0.71']
9:(6) ['International Business Machines', 'IBM', 'Tech', '0.9', '121', '0.83']
10:(6) ['Tesla', 'TSLA', 'Automotive', '3.13', '215', '2.13']
11:(6) ['Pfizer', 'PFE', 'Pharmaceuticals', '5.61', '43', '0.64']
12:(6) ['DocuSign', 'DOCU', 'Tech', '0.2', '46', '1.21']
13:(6) ['EPAM Systems', 'EPAM', 'Tech', '0.057', '333', '1.68']
14:(6) ['GitLab', 'GTLB', 'Software', '0.148', '45', '']
length:15
*/

    //! We don't want the header. We can invoke the .entries() and skip index === 0 (skip the first row)
    /* 
let stockData_3 = [];
    for (let [index, row] of rows.entries()) {
      if(index === 0) {
        continue;
      }
      stockData_3.push(row.innerText.split("\t"));
    }

    console.log("For...of 3", stockData_3);
 */
    /* output:

Uncaught TypeError: rows.entries is not a function or its return value is not iterable

The for...of loop works on every iterable but on arrays only, not on HTML collections, so we can use Array.from to convert the HTMLCollection. */

    let stockData_4 = [];
    for (let [index, row] of Array.from(rows).entries()) {
      if (index === 0) {
        continue;
      }
      stockData_4.push(row.innerText.split("\t"));
    }

    console.log("For...of 4", stockData_4);

    /* Output: 

   (14) [Array(6), Array(6), Array(6), Array(6), Array(6), Array(6), Array(6), Array(6), Array(6), Array(6), Array(6), Array(6), Array(6), Array(6)]
0: (6) ['Microsoft', 'MSFT', 'Tech', '7.46', '220', '0.96']
1: (6) ['Apple', 'APPL', 'Tech', '16.07', '142', '1.25']
2: (6) ['Amazon', 'AMZN', 'Retail', '10.19', '113', '1.32']
3: (6) ['Alphabet Inc.', 'GOOG', 'Tech', '13', '100', '1.10']
4: (6) ['Walmart', 'WMT', 'Retail', '2.71', '131', '0.51']
5: (6) ['Exxon Mobil', 'XOM', 'Petroleum', '4.17', '101', '1.05']
6: (6) ['JP Morgan', 'JPM', 'Financial Services', '2.93', '115', '1.07']
7: (6) ['Intel', 'INTC', 'Tech', '4.11', '26', '0.71']
8: (6) ['International Business Machines', 'IBM', 'Tech', '0.9', '121', '0.83']
9: (6) ['Tesla', 'TSLA', 'Automotive', '3.13', '215', '2.13']
10: (6) ['Pfizer', 'PFE', 'Pharmaceuticals', '5.61', '43', '0.64']
11: (6) ['DocuSign', 'DOCU', 'Tech', '0.2', '46', '1.21']
12: (6) ['EPAM Systems', 'EPAM', 'Tech', '0.057', '333', '1.68']
13: (6) ['GitLab', 'GTLB', 'Software', '0.148', '45', '']
length: 14 
*/

// Refactor the above:

let stockData_5 = [];
const tableNoHeader = Array.from(rows).slice(1);
    for (let row of tableNoHeader) {
      stockData_5.push(row.innerText.split("\t"));
    }

    console.log("For...of 5", stockData_4);

 /* Output: 

   (14) [Array(6), Array(6), Array(6), Array(6), Array(6), Array(6), Array(6), Array(6), Array(6), Array(6), Array(6), Array(6), Array(6), Array(6)]
0: (6) ['Microsoft', 'MSFT', 'Tech', '7.46', '220', '0.96']
1: (6) ['Apple', 'APPL', 'Tech', '16.07', '142', '1.25']
2: (6) ['Amazon', 'AMZN', 'Retail', '10.19', '113', '1.32']
3: (6) ['Alphabet Inc.', 'GOOG', 'Tech', '13', '100', '1.10']
4: (6) ['Walmart', 'WMT', 'Retail', '2.71', '131', '0.51']
5: (6) ['Exxon Mobil', 'XOM', 'Petroleum', '4.17', '101', '1.05']
6: (6) ['JP Morgan', 'JPM', 'Financial Services', '2.93', '115', '1.07']
7: (6) ['Intel', 'INTC', 'Tech', '4.11', '26', '0.71']
8: (6) ['International Business Machines', 'IBM', 'Tech', '0.9', '121', '0.83']
9: (6) ['Tesla', 'TSLA', 'Automotive', '3.13', '215', '2.13']
10: (6) ['Pfizer', 'PFE', 'Pharmaceuticals', '5.61', '43', '0.64']
11: (6) ['DocuSign', 'DOCU', 'Tech', '0.2', '46', '1.21']
12: (6) ['EPAM Systems', 'EPAM', 'Tech', '0.057', '333', '1.68']
13: (6) ['GitLab', 'GTLB', 'Software', '0.148', '45', '']
length: 14 
*/

// Receive just the Symbol and the price of the stock

let output = '';
for(let stock of stockData_5) {
  const symbol = stock.at(1);
  const price = stock.at(5);
  output += `${symbol} is currently trading at ${price}\n`;
}
console.log(output);
/* 
MSFT is currently trading at 0.96
APPL is currently trading at 1.25
AMZN is currently trading at 1.32
GOOG is currently trading at 1.10
WMT is currently trading at 0.51
XOM is currently trading at 1.05
JPM is currently trading at 1.07
INTC is currently trading at 0.71
IBM is currently trading at 0.83
TSLA is currently trading at 2.13
PFE is currently trading at 0.64
DOCU is currently trading at 1.21
EPAM is currently trading at 1.68
GTLB is currently trading at  
*/

// Let's calculate the market capitalization of each company. We need to take the number of shares and multiply it by the price.
const marketCaps = new Map();
for (const stock of stockData_2) {
  const name = stock.at(0); // This gets us a string, but since we will be doing a mathematical operation, we want to wrap it into the Number constructor.
  const marketCap = Number(stock.at(3)) * Number(stock.at(4)); // set these variables as key/value pairs.
  marketCaps.set(name, marketCap);
}
console.log(marketCaps);

// filtering only large Cap companies

const megaCaps = [];
const megaCapLimit = 200;
for (const company of marketCaps) {
  if (company[1] >= megaCapLimit) {
    megaCaps.push(company[0]);
  }
}
console.log(`Large Cap companies: ${megaCaps}`);


  </script>
</html>
